# (C) Copyright 2025 Anemoi contributors.
#
# This software is licensed under the terms of the Apache Licence Version 2.0
# which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.
#
# In applying this licence, ECMWF does not waive the privileges and immunities
# granted to it by virtue of its status as an intergovernmental organisation
# nor does it submit to any jurisdiction.

import numpy as np
from earthkit.meteo.constants.constants import R as R_universal_gas_constant
from earthkit.meteo.constants.constants import g as g_gravitational_acceleration

__all__ = ["g_gravitational_acceleration", "R_universal_gas_constant", "model_level_AB"]


# A and B-coefficients defining the model levels for different models
# Only IFS with 137 vertical levels implemented for now
model_level_AB = {
    "IFS_137": {
        "A": np.array(
            [
                0.00000000e00,
                2.00036500e00,
                3.10224100e00,
                4.66608400e00,
                6.82797700e00,
                9.74696600e00,
                1.36054240e01,
                1.86089310e01,
                2.49857180e01,
                3.29857100e01,
                4.28792420e01,
                5.49554630e01,
                6.95205760e01,
                8.68958820e01,
                1.07415741e02,
                1.31425507e02,
                1.59279404e02,
                1.91338562e02,
                2.27968948e02,
                2.69539581e02,
                3.16420746e02,
                3.68982361e02,
                4.27592499e02,
                4.92616028e02,
                5.64413452e02,
                6.43339905e02,
                7.29744141e02,
                8.23967834e02,
                9.26344910e02,
                1.03720117e03,
                1.15685364e03,
                1.28561035e03,
                1.42377014e03,
                1.57162292e03,
                1.72944898e03,
                1.89751929e03,
                2.07609595e03,
                2.26543164e03,
                2.46577051e03,
                2.67734814e03,
                2.90039136e03,
                3.13511938e03,
                3.38174365e03,
                3.64046826e03,
                3.91149048e03,
                4.19493066e03,
                4.49081738e03,
                4.79914941e03,
                5.11989502e03,
                5.45299072e03,
                5.79834473e03,
                6.15607422e03,
                6.52694678e03,
                6.91187061e03,
                7.31186914e03,
                7.72741211e03,
                8.15935400e03,
                8.60852539e03,
                9.07640039e03,
                9.56268262e03,
                1.00659785e04,
                1.05846318e04,
                1.11166621e04,
                1.16600674e04,
                1.22115479e04,
                1.27668730e04,
                1.33246689e04,
                1.38813311e04,
                1.44321396e04,
                1.49756152e04,
                1.55082568e04,
                1.60261152e04,
                1.65273223e04,
                1.70087891e04,
                1.74676133e04,
                1.79016211e04,
                1.83084336e04,
                1.86857188e04,
                1.90312891e04,
                1.93435117e04,
                1.96200430e04,
                1.98593906e04,
                2.00599316e04,
                2.02196641e04,
                2.03378633e04,
                2.04123086e04,
                2.04420781e04,
                2.04257188e04,
                2.03618164e04,
                2.02495117e04,
                2.00870859e04,
                1.98740254e04,
                1.96085723e04,
                1.92902266e04,
                1.89174609e04,
                1.84897070e04,
                1.80069258e04,
                1.74718398e04,
                1.68886875e04,
                1.62620469e04,
                1.55966953e04,
                1.48984531e04,
                1.41733242e04,
                1.34277695e04,
                1.26682578e04,
                1.19013398e04,
                1.11333047e04,
                1.03701758e04,
                9.61751562e03,
                8.88045312e03,
                8.16337500e03,
                7.47034375e03,
                6.80442188e03,
                6.16853125e03,
                5.56438281e03,
                4.99379688e03,
                4.45737500e03,
                3.95596094e03,
                3.48923438e03,
                3.05726562e03,
                2.65914062e03,
                2.29424219e03,
                1.96150000e03,
                1.65947656e03,
                1.38754688e03,
                1.14325000e03,
                9.26507813e02,
                7.34992188e02,
                5.68062500e02,
                4.24414063e02,
                3.02476563e02,
                2.02484375e02,
                1.22101563e02,
                6.27812500e01,
                2.28359380e01,
                3.75781300e00,
                0.00000000e00,
                0.00000000e00,
            ]
        ),
        "B": np.array(
            [
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                0.00000e00,
                7.00000e-06,
                2.40000e-05,
                5.90000e-05,
                1.12000e-04,
                1.99000e-04,
                3.40000e-04,
                5.62000e-04,
                8.90000e-04,
                1.35300e-03,
                1.99200e-03,
                2.85700e-03,
                3.97100e-03,
                5.37800e-03,
                7.13300e-03,
                9.26100e-03,
                1.18060e-02,
                1.48160e-02,
                1.83180e-02,
                2.23550e-02,
                2.69640e-02,
                3.21760e-02,
                3.80260e-02,
                4.45480e-02,
                5.17730e-02,
                5.97280e-02,
                6.84480e-02,
                7.79580e-02,
                8.82860e-02,
                9.94620e-02,
                1.11505e-01,
                1.24448e-01,
                1.38313e-01,
                1.53125e-01,
                1.68910e-01,
                1.85689e-01,
                2.03491e-01,
                2.22333e-01,
                2.42244e-01,
                2.63242e-01,
                2.85354e-01,
                3.08598e-01,
                3.32939e-01,
                3.58254e-01,
                3.84363e-01,
                4.11125e-01,
                4.38391e-01,
                4.66003e-01,
                4.93800e-01,
                5.21619e-01,
                5.49301e-01,
                5.76692e-01,
                6.03648e-01,
                6.30036e-01,
                6.55736e-01,
                6.80643e-01,
                7.04669e-01,
                7.27739e-01,
                7.49797e-01,
                7.70798e-01,
                7.90717e-01,
                8.09536e-01,
                8.27256e-01,
                8.43881e-01,
                8.59432e-01,
                8.73929e-01,
                8.87408e-01,
                8.99900e-01,
                9.11448e-01,
                9.22096e-01,
                9.31881e-01,
                9.40860e-01,
                9.49064e-01,
                9.56550e-01,
                9.63352e-01,
                9.69513e-01,
                9.75078e-01,
                9.80072e-01,
                9.84542e-01,
                9.88500e-01,
                9.91984e-01,
                9.95003e-01,
                9.97630e-01,
                1.00000e0,
            ]
        ),
    }
}
